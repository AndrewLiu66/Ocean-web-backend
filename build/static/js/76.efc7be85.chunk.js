(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[76],{377:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const o={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},378:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return a}));var o=n(135),r=n(147),i=n(377),s=n(347);function a(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?s.a:"esriGeometryPolyline"===e?s.c:s.b}}}const c=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let l=1;function u(e,t){if(Object(o.a)("esri-csp-restrictions"))return()=>({[t]:null,...e});try{let n="this.".concat(t," = null;");for(const t in e)n+="this".concat(c.test(t)?".".concat(t):'["'.concat(t,'"]')," = ").concat(JSON.stringify(e[t]),";");const o=new Function("\n      return class AttributesClass$".concat(l++," {\n        constructor() {\n          ").concat(n,";\n        }\n      }\n    "))();return()=>new o}catch(n){return()=>({[t]:null,...e})}}function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:Object(r.a)(e)}}]}function d(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0},query:i.a,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}}},468:function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return w})),n.d(t,"d",(function(){return v}));var o=n(145),r=n(329),i=n(197),s=n(234);const a={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};function c(e){return a[e]}function*l(e){switch(e.type){case"Feature":yield e;break;case"FeatureCollection":for(const t of e.features)t&&(yield t)}}function*u(e){if(!e)return null;switch(e.type){case"Point":yield e.coordinates;break;case"LineString":case"MultiPoint":yield*e.coordinates;break;case"MultiLineString":case"Polygon":for(const t of e.coordinates)yield*t;break;case"MultiPolygon":for(const t of e.coordinates)for(const e of t)yield*e}}function p(e){for(const t of e)if(t.length>2)return!0;return!1}function d(e){let t=0;for(let n=0;n<e.length;n++){const o=e[n],r=e[(n+1)%e.length];t+=o[0]*r[1]-r[0]*o[1]}return t<=0}function y(e){const t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]||e.push(t),e}function f(e,t,n){switch(t.type){case"LineString":case"MultiPoint":return function(e,t,n){return m(e,t.coordinates,n),e}(e,t,n);case"MultiLineString":return function(e,t,n){for(const o of t.coordinates)m(e,o,n);return e}(e,t,n);case"MultiPolygon":return function(e,t,n){for(const o of t.coordinates){b(e,o[0],n);for(let t=1;t<o.length;t++)g(e,o[t],n)}return e}(e,t,n);case"Point":return function(e,t,n){return j(e,t.coordinates,n),e}(e,t,n);case"Polygon":return function(e,t,n){const o=t.coordinates;b(e,o[0],n);for(let r=1;r<o.length;r++)g(e,o[r],n);return e}(e,t,n)}}function b(e,t,n){const o=y(t);!function(e){return!d(e)}(o)?m(e,o,n):h(e,o,n)}function g(e,t,n){const o=y(t);!function(e){return d(e)}(o)?m(e,o,n):h(e,o,n)}function m(e,t,n){for(const o of t)j(e,o,n);e.lengths.push(t.length)}function h(e,t,n){for(let o=t.length-1;o>=0;o--)j(e,t[o],n);e.lengths.push(t.length)}function j(e,t,n){const[o,r,i]=t;e.coords.push(o,r),n.hasZ&&e.coords.push(i||0)}function O(e){switch(typeof e){case"string":return"esriFieldTypeString";case"number":return"esriFieldTypeDouble";default:return"unknown"}}function v(e){if(!e)throw new o.a("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==e.type&&"FeatureCollection"!==e.type)throw new o.a("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:e});const{crs:t}=e;if(!t)return;const n="string"==typeof t?t:"name"===t.type?t.properties.name:"EPSG"===t.type?t.properties.code:null,r=new RegExp(".*(CRS84H?|4326)$","i");if(!n||!r.test(n))throw new o.a("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:t})}function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[],o=new Set,r=new Set;let i,a=!1,d=null,y=!1,{geometryType:f=null}=t,b=!1;for(const s of l(e)){const{geometry:e,properties:t,id:l}=s;if((!e||(f||(f=c(e.type)),c(e.type)===f))&&(a||(a=p(u(e))),y||(y=null!=l,y&&(i=typeof l,d=Object.keys(t).filter((e=>t[e]===l)))),y&&null!=l&&(d.length>1?d=d.filter((e=>t[e]===l)):1===d.length&&(d=t[d[0]]===l?d:[])),!b&&t)){let e=!0;for(const i in t){if(o.has(i))continue;const s=t[i];if(null==s){e=!1,r.add(i);continue}const a=O(s);"unknown"!==a?(r.delete(i),o.add(i),n.push({name:i,alias:i,type:a})):r.add(i)}b=e}}const g=d&&1===d.length&&d[0]||null;if(g)for(const c of n)if(c.name===g&&Object(s.p)(c)){c.type="esriFieldTypeOID";break}return{fields:n,geometryType:f,hasZ:a,objectIdFieldName:g,objectIdFieldType:i,unknownFields:Array.from(r)}}function S(e,t){return Array.from(function*(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{geometryType:n,objectIdField:o}=t;for(const a of e){var s;const{geometry:e,properties:l,id:u}=a;if(e&&c(e.type)!==n)continue;const p=l||{};let d=null!==(s=p[o])&&void 0!==s?s:null;o&&null!=u&&!p[o]&&(p[o]=d=u);const y=new r.a(e?f(new i.a,e,t):null,p,null,d);yield y}}(l(e),t))}},673:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return L}));var o=n(136),r=(n(163),n(255)),i=(n(371),n(424),n(439),n(440),n(436),n(346),n(412),n(389),n(403),n(445)),s=n(248),a=n(139),c=(n(141),n(135),n(138),n(137)),l=n(369),u=n(260),p=n(145),d=n(328),y=n(134),f=n(859),b=n(273),g=n(169);let m=class extends d.a{constructor(){super(...arguments),this.featureDefinition=null,this.type="ogc-feature"}load(e){return this.addResolvingPromise(this._loadOGCServices(this.layer,e)),this.when()}getFeatureDefinition(){const{featureDefinition:{collection:e,layerDefinition:t,spatialReference:n,supportedCrs:o},layer:{apiKey:r,capabilities:i,customParameters:s}}=this;return{capabilities:i,collection:e,layerDefinition:t,queryParameters:{apiKey:r,customParameters:s},spatialReference:n,supportedCrs:o}}queryExtent(e){return null}queryFeatureCount(e){return null}queryFeatures(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.queryFeaturesJSON(e,t).then((e=>b.default.fromJSON(e)))}queryFeaturesJSON(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.getFeatureDefinition();return this.load(t).then((()=>Object(f.i)(n,e,t)))}queryObjectIds(e){return null}serviceSupportsSpatialReference(e){return!(!e.isWGS84&&!e.isWebMercator)||!!this.featureDefinition.supportedCrs[e.wkid]}_conformsToType(e,t){var n;const o=new RegExp("^".concat(t,"$"),"i");return null!==(n=e.conformsTo.some((e=>o.test(e))))&&void 0!==n&&n}_getCapabilities(e,t){var n,o,r,i,s,a,c;const l=Object(y.k)(t)?null===(n=t.components)||void 0===n?void 0:n.parameters:null;return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1},query:{maxRecordCount:null!==(o=null!==(r=null===l||void 0===l||null===(i=l.limit)||void 0===i||null===(s=i.schema)||void 0===s?void 0:s.maximum)&&void 0!==r?r:null===l||void 0===l||null===(a=l.limitFeatures)||void 0===a||null===(c=a.schema)||void 0===c?void 0:c.maximum)&&void 0!==o?o:5e3,maxRecordCountFactor:void 0,standardMaxRecordCount:void 0,supportsCacheHint:!1,supportsCentroid:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsStatistics:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsDefaultSpatialReference:!1,supportsCompactGeometry:!1,supportsSqlExpression:!1,tileMaxRecordCount:void 0},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUploadWithItemId:!1,supportsUpdateWithoutM:!1}}}_getExtent(e){var t;const n=null===(t=e.extent)||void 0===t?void 0:t.spatial;if(!n)return null;const o=n.bbox[0],r=4===o.length,i=o[0],s=o[1],a=r?void 0:o[2];return{xmin:i,ymin:s,xmax:r?o[2]:o[3],ymax:r?o[3]:o[4],zmin:a,zmax:r?void 0:o[5],spatialReference:g.a.WGS84.toJSON()}}_getStorageSpatialReference(e){var t;const n=null!==(t=e.storageCrs)&&void 0!==t?t:f.a,o=Object(f.h)(n);return Object(y.j)(o)?g.a.WGS84:new g.a({wkid:o})}_getSupportedSpatialReferences(e,t){var n;const o="#/crs",r=null!==(n=e.crs)&&void 0!==n?n:[f.a],i=r.includes(o)?r.filter((e=>e!==o)).concat(t.crs):r,s=/^http:\/\/www\.opengis.net\/def\/crs\/epsg\/.*\/3785$/i;return i.filter((e=>!s.test(e)))}async _loadOGCServices(e,t){const n=Object(y.k)(t)?t.signal:null,{apiKey:o,collectionId:r,customParameters:i,fields:s,geometryType:a,hasZ:c,objectIdField:u,timeInfo:d,url:b}=e,g={fields:null===s||void 0===s?void 0:s.map((e=>e.toJSON())),geometryType:l.c.toJSON(a),hasZ:c,objectIdField:u,timeInfo:null===d||void 0===d?void 0:d.toJSON()},m={apiKey:o,customParameters:i,signal:n},h=await Object(f.f)(b,m),[j,O]=await Promise.all([Object(f.e)(h,m),Object(f.d)(h,m)]);if(!this._conformsToType(j,"http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/geojson"))throw new p.a("ogc-feature-layer:no-geojson-support","Server does not support geojson");const v=O.collections.find((e=>e.id===r));if(!v)throw new p.a("ogc-feature-layer:collection-not-found","Server does not contain the named collection");const w=this._conformsToType(j,"http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/oas30")?await Object(f.g)(h,m):null,S=await Object(f.c)(v,g,m),F=this._getCapabilities(S.hasZ,w),I=this._getExtent(v),T=this._getStorageSpatialReference(v).toJSON(),x=this._getSupportedSpatialReferences(v,O),C=new RegExp("^".concat(f.b),"i"),P={};for(const l of x){const e=Object(f.h)(l);Object(y.k)(e)&&(P[e]||(P[e]=l.replace(C,"")))}S.extent=I,this.featureDefinition={capabilities:F,collection:v,layerDefinition:S,queryParameters:{},spatialReference:T,supportedCrs:P}}};Object(o.a)([Object(a.b)()],m.prototype,"featureDefinition",void 0),Object(o.a)([Object(a.b)({constructOnly:!0})],m.prototype,"layer",void 0),Object(o.a)([Object(a.b)()],m.prototype,"type",void 0),m=Object(o.a)([Object(c.a)("esri.layers.graphics.sources.OGCFeatureSource")],m);var h=n(463),j=n(318),O=n(464),v=n(605),w=n(281),S=n(773),F=n(285),I=n(386),T=n(286),x=n(478),C=n(241),P=n(654),R=n(606),k=n(338),D=n(501),G=n(234),M=n(472),q=n(564),E=n(251),A=n(446),N=n(161);const Q=Object(D.a)();let _=class extends(Object(h.a)(Object(O.a)(Object(v.a)(Object(j.a)(Object(S.a)(Object(x.a)(Object(T.a)(Object(w.a)(Object(F.a)(Object(I.a)(Object(s.a)(u.a)))))))))))){constructor(e){super(e),this.collectionId=null,this.copyright=null,this.definitionExpression=null,this.description=null,this.displayField=null,this.elevationInfo=null,this.featureReduction=null,this.fields=null,this.fieldsIndex=null,this.fullExtent=null,this.geometryType=null,this.hasZ=void 0,this.labelingInfo=null,this.labelsVisible=!0,this.legendEnabled=!0,this.objectIdField=null,this.operationalLayerType="OGCFeatureLayer",this.popupEnabled=!0,this.popupTemplate=null,this.screenSizePerspectiveEnabled=!0,this.source=new m({layer:this}),this.spatialReference=null,this.title=null,this.type="ogc-feature",this.typeIdField=null,this.types=null,this.url=null}destroy(){var e;null===(e=this.source)||void 0===e||e.destroy()}load(e){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["OGCFeatureServer"]},e).then((()=>this._fetchService(e)))),this.when()}get defaultPopupTemplate(){return this.createPopupTemplate()}get isTable(){return this.loaded&&null==this.geometryType}set renderer(e){Object(G.k)(e,this.fieldsIndex),this._set("renderer",e)}on(e,t){return super.on(e,t)}createPopupTemplate(e){return Object(A.a)(this,e)}createQuery(){return new E.a}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,t){var n;let o,r=!1;const i=null===t||void 0===t||null===(n=t.feature)||void 0===n?void 0:n.attributes,s=this.typeIdField&&(null===i||void 0===i?void 0:i[this.typeIdField]);return null!=s&&this.types&&(r=this.types.some((t=>{var n,r;return t.id==s&&(o=null===(n=t.domains)||void 0===n?void 0:n[e],"inherited"===(null===(r=o)||void 0===r?void 0:r.type)&&(o=this._getLayerDomain(e)),!0)}))),r||o||(o=this._getLayerDomain(e)),o}queryFeatures(e,t){return this.load().then((()=>this.source.queryFeatures(E.a.from(e)||this.createQuery(),t))).then((e=>{var t;return null!==e&&void 0!==e&&null!==(t=e.features)&&void 0!==t&&t.forEach((e=>{e.layer=e.sourceLayer=this})),e}))}serviceSupportsSpatialReference(e){var t,n;return null!==(t=null===(n=this.source)||void 0===n?void 0:n.serviceSupportsSpatialReference(e))&&void 0!==t&&t}async _fetchService(e){await this.source.load(e),this.read(this.source.featureDefinition,{origin:"service"}),Object(G.k)(this.renderer,this.fieldsIndex),Object(G.l)(this.timeInfo,this.fieldsIndex)}_getLayerDomain(e){if(!this.fields)return null;for(const t of this.fields)if(t.name===e&&t.domain)return t.domain;return null}};Object(o.a)([Object(a.b)({readOnly:!0,json:{origins:{service:{read:!0}}}})],_.prototype,"capabilities",void 0),Object(o.a)([Object(a.b)({type:String,json:{write:!0}})],_.prototype,"collectionId",void 0),Object(o.a)([Object(a.b)({type:String})],_.prototype,"copyright",void 0),Object(o.a)([Object(a.b)({readOnly:!0})],_.prototype,"defaultPopupTemplate",null),Object(o.a)([Object(a.b)({type:String})],_.prototype,"definitionExpression",void 0),Object(o.a)([Object(a.b)({readOnly:!0,type:String,json:{origins:{service:{name:"collection.description"}}}})],_.prototype,"description",void 0),Object(o.a)([Object(a.b)({type:String})],_.prototype,"displayField",void 0),Object(o.a)([Object(a.b)(C.b)],_.prototype,"elevationInfo",void 0),Object(o.a)([Object(a.b)(P.a)],_.prototype,"featureReduction",void 0),Object(o.a)([Object(a.b)({type:[k.a],json:{origins:{service:{name:"layerDefinition.fields"}}}})],_.prototype,"fields",void 0),Object(o.a)([Object(a.b)(Q.fieldsIndex)],_.prototype,"fieldsIndex",void 0),Object(o.a)([Object(a.b)({readOnly:!0,type:N.a,json:{origins:{service:{name:"layerDefinition.extent"}}}})],_.prototype,"fullExtent",void 0),Object(o.a)([Object(a.b)({type:l.a.apiValues,json:{origins:{service:{name:"layerDefinition.geometryType",read:{reader:l.a.read}}}}})],_.prototype,"geometryType",void 0),Object(o.a)([Object(a.b)({type:Boolean,json:{origins:{service:{name:"layerDefinition.hasZ"}}}})],_.prototype,"hasZ",void 0),Object(o.a)([Object(a.b)({type:Boolean,readOnly:!0})],_.prototype,"isTable",null),Object(o.a)([Object(a.b)({type:[M.a],json:{origins:{"web-document":{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:q.a},write:!0}}}})],_.prototype,"labelingInfo",void 0),Object(o.a)([Object(a.b)(C.d)],_.prototype,"labelsVisible",void 0),Object(o.a)([Object(a.b)(C.e)],_.prototype,"legendEnabled",void 0),Object(o.a)([Object(a.b)({type:String,json:{origins:{service:{name:"layerDefinition.objectIdField"}}}})],_.prototype,"objectIdField",void 0),Object(o.a)([Object(a.b)({type:["OGCFeatureLayer"]})],_.prototype,"operationalLayerType",void 0),Object(o.a)([Object(a.b)(C.k)],_.prototype,"popupEnabled",void 0),Object(o.a)([Object(a.b)({type:r.a,json:{name:"popupInfo",write:!0}})],_.prototype,"popupTemplate",void 0),Object(o.a)([Object(a.b)({types:i.a,json:{origins:{service:{name:"layerDefinition.drawingInfo.renderer",write:!1},"web-scene":{types:i.b,name:"layerDefinition.drawingInfo.renderer",write:!0}},name:"layerDefinition.drawingInfo.renderer",write:!0}})],_.prototype,"renderer",null),Object(o.a)([Object(a.b)(C.n)],_.prototype,"screenSizePerspectiveEnabled",void 0),Object(o.a)([Object(a.b)({readOnly:!0})],_.prototype,"source",void 0),Object(o.a)([Object(a.b)({readOnly:!0,type:g.a,json:{origins:{service:{read:!0}}}})],_.prototype,"spatialReference",void 0),Object(o.a)([Object(a.b)({type:String,json:{write:{enabled:!0,ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"collection.title"}}}})],_.prototype,"title",void 0),Object(o.a)([Object(a.b)({readOnly:!0,json:{read:!1}})],_.prototype,"type",void 0),Object(o.a)([Object(a.b)({type:String,readOnly:!0})],_.prototype,"typeIdField",void 0),Object(o.a)([Object(a.b)({type:[R.a]})],_.prototype,"types",void 0),Object(o.a)([Object(a.b)(C.o)],_.prototype,"url",void 0),_=Object(o.a)([Object(c.a)("esri.layers.OGCFeatureLayer")],_);const L=_},859:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return j})),n.d(t,"d",(function(){return O})),n.d(t,"e",(function(){return v})),n.d(t,"f",(function(){return w})),n.d(t,"g",(function(){return S})),n.d(t,"h",(function(){return F})),n.d(t,"i",(function(){return I})),n.d(t,"j",(function(){return T}));n(163);var o=n(166),r=n(145),i=n(143),s=n(134),a=n(170),c=n(294),l=n(174),u=n(726),p=n(468),d=n(378),y=n(304),f=n(523),b=n(169);const g=i.a.getLogger("esri.layers.graphics.sources.ogcfeature"),m="http://www.opengis.net/def/crs/",h="".concat(m,"OGC/1.3/CRS84");async function j(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const{links:a}=e,c=R(a,"items","application/geo+json")||R(a,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if(Object(s.j)(c))throw new r.a("ogc-feature-layer:missing-items-page","Missing items url");const{data:l}=await Object(o.default)(c.href,{signal:n.signal,query:{limit:i,...n.customParameters,token:n.apiKey},headers:{accept:"application/geo+json"}});await Object(p.d)(l);const u=Object(p.c)(l,{geometryType:t.geometryType}),b=t.fields||u.fields||[],m=null!=t.hasZ?t.hasZ:u.hasZ,h=u.geometryType,j=t.objectIdField||u.objectIdFieldName||"OBJECTID";let O=t.timeInfo;const v=b.find((e=>e.name===j));if(v)v.type="esriFieldTypeOID",v.editable=!1,v.nullable=!1;else{if(!u.objectIdFieldType)throw new r.a("ogc-feature-layer:missing-feature-id","Collection geojson require a feature id as a unique identifier");b.unshift({name:j,alias:j,type:"esriFieldTypeOID",editable:!1,nullable:!1})}if(j!==u.objectIdFieldName){const e=b.find((e=>e.name===u.objectIdFieldName));e&&(e.type="esriFieldTypeInteger")}b===u.fields&&u.unknownFields.length>0&&g.warn({name:"ogc-feature-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:u.unknownFields}});for(const o of b){if(null==o.name&&(o.name=o.alias),null==o.alias&&(o.alias=o.name),"esriFieldTypeOID"!==o.type&&"esriFieldTypeGlobalID"!==o.type&&(o.editable=null==o.editable||!!o.editable,o.nullable=null==o.nullable||!!o.nullable),!o.name)throw new r.a("ogc-feature-layer:invalid-field-name","field name is missing",{field:o});if(!f.a.jsonValues.includes(o.type))throw new r.a("ogc-feature-layer:invalid-field-type",'invalid type for field "'.concat(o.name,'"'),{field:o})}if(O){const e=new y.a(b);if(O.startTimeField){const t=e.get(O.startTimeField);t?(O.startTimeField=t.name,t.type="esriFieldTypeDate"):O.startTimeField=null}if(O.endTimeField){const t=e.get(O.endTimeField);t?(O.endTimeField=t.name,t.type="esriFieldTypeDate"):O.endTimeField=null}if(O.trackIdField){const t=e.get(O.trackIdField);t?O.trackIdField=t.name:(O.trackIdField=null,g.warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:O}}))}O.startTimeField||O.endTimeField||(g.warn({name:"ogc-feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:O}}),O=null)}return{drawingInfo:h?Object(d.d)(h):null,geometryType:h,fields:b,hasZ:!!m,objectIdField:j,timeInfo:O}}async function O(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{links:n}=e,i=R(n,"data","application/json")||R(n,"http://www.opengis.net/def/rel/ogc/1.0/data","application/json");if(Object(s.j)(i))throw new r.a("ogc-feature-layer:missing-collections-page","Missing collections url");const{apiKey:a,customParameters:c,signal:l}=t,{data:u}=await Object(o.default)(i.href,{signal:l,headers:{accept:"application/json"},query:{...c,token:a}});return u}async function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{links:n}=e,i=R(n,"conformance","application/json")||R(n,"http://www.opengis.net/def/rel/ogc/1.0/conformance","application/json");if(Object(s.j)(i))throw new r.a("ogc-feature-layer:missing-conformance-page","Missing conformance url");const{apiKey:a,customParameters:c,signal:l}=t,{data:u}=await Object(o.default)(i.href,{signal:l,headers:{accept:"application/json"},query:{...c,token:a}});return u}async function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{apiKey:n,customParameters:r,signal:i}=t,{data:s}=await Object(o.default)(e,{signal:i,headers:{accept:"application/json"},query:{...r,token:n}});return s}async function S(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n="application/vnd.oai.openapi+json;version=3.0",r=R(e.links,"service-desc",n);if(Object(s.j)(r))return g.warn("ogc-feature-layer:missing-openapi-page","The OGC API-Features server does not have an OpenAPI page."),null;const{apiKey:i,customParameters:a,signal:c}=t,{data:l}=await Object(o.default)(r.href,{signal:c,headers:{accept:n},query:{...a,token:i}});return l}function F(e){var t;const n=null===(t=/^http:\/\/www\.opengis.net\/def\/crs\/(?<authority>.*)\/(?<version>.*)\/(?<code>.*)$/i.exec(e))||void 0===t?void 0:t.groups;if(!n)return null;const{authority:o,code:r}=n;switch(o.toLowerCase()){case"ogc":switch(r.toLowerCase()){case"crs27":return b.a.GCS_NAD_1927.wkid;case"crs83":return 4269;case"crs84":case"crs84h":return b.a.WGS84.wkid;default:return null}case"esri":case"epsg":{const e=Number.parseInt(r,10);return Number.isNaN(e)?null:e}default:return null}}async function I(e,t,n){const o=await T(e,t,n);return Object(l.j)(o)}async function T(e,t,n){const{capabilities:{query:{maxRecordCount:i}},collection:d,layerDefinition:y,queryParameters:{apiKey:f,customParameters:g},spatialReference:m,supportedCrs:h}=e,{links:j}=d,O=R(j,"items","application/geo+json")||R(j,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if(Object(s.j)(O))throw new r.a("ogc-feature-layer:missing-items-page","Missing items url");const{geometry:v,num:w,start:S,timeExtent:F,where:I}=t;if(t.objectIds)throw new r.a("ogc-feature-layer:query-by-objectids-not-supported","Queries with objectids are not supported");const T=b.a.fromJSON(m),C=Object(s.r)(t.outSpatialReference,T),k=C.isWGS84?null:x(C,h),D=P(v,h),G=function(e){if(Object(s.j)(e))return null;const{start:t,end:n}=e;return"".concat(Object(s.k)(t)?t.toISOString():"..","/").concat(Object(s.k)(n)?n.toISOString():"..")}(F),M=(A=I,Object(s.j)(A)||!A||"1=1"===A?null:A),q=null!==w&&void 0!==w?w:null!=S&&void 0!==S?10:i,{data:E}=await Object(o.default)(O.href,{...n,query:{...g,...D,crs:k,datetime:G,query:M,limit:q,startindex:S,token:f},headers:{accept:"application/geo+json"}});var A;let N=!1;if(E.links){N=!!E.links.find((e=>"next"===e.rel))}!N&&Number.isInteger(E.numberMatched)&&Number.isInteger(E.numberReturned)&&(N=E.numberReturned<E.numberMatched);const{fields:Q,globalIdField:_,hasM:L,hasZ:B,objectIdField:Z}=y,J=y.geometryType,W=Object(p.a)(E,{geometryType:J,hasZ:B,objectIdField:Z});if(!k&&C.isWebMercator)for(const o of W)if(Object(s.k)(o.geometry)){const e=Object(l.k)(o.geometry,J,B,!1);e.spatialReference=b.a.WGS84,o.geometry=Object(l.d)(Object(c.d)(e,C))}for(const o of W)o.objectId=o.attributes[Z];const H=k||!k&&C.isWebMercator?C.toJSON():a.b,z=new u.a;return z.exceededTransferLimit=N,z.features=W,z.fields=Q,z.geometryType=J,z.globalIdFieldName=_,z.hasM=L,z.hasZ=B,z.objectIdFieldName=Z,z.spatialReference=H,z}function x(e,t){var n,o,r;const{isWebMercator:i,wkid:s}=e;if(!s)return null;const a=i?null!==(n=null!==(o=null!==(r=t[3857])&&void 0!==r?r:t[102100])&&void 0!==o?o:t[102113])&&void 0!==n?n:t[900913]:t[e.wkid];return a?"".concat(m).concat(a):null}function C(e){if(Object(s.j)(e))return"";const{xmin:t,ymin:n,xmax:o,ymax:r}=e;return"".concat(t,",").concat(n,",").concat(o,",").concat(r)}function P(e,t){if(!function(e){return Object(s.k)(e)&&"extent"===e.type}(e))return null;const{spatialReference:n}=e;if(!n||n.isWGS84)return{bbox:C(e)};const o=x(n,t);return Object(s.k)(o)?{bbox:C(e),"bbox-crs":o}:n.isWebMercator?{bbox:C(Object(c.d)(e,b.a.WGS84))}:null}function R(e,t,n){return e.find((e=>e.rel===t&&e.type===n))||e.find((e=>e.rel===t&&!e.type))}}}]);