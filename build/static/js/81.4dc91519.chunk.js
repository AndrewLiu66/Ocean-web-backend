(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[81,89],{1030:function(e,t,a){"use strict";a.r(t),a.d(t,"fromItem",(function(){return s})),a.d(t,"selectLayerClassPath",(function(){return c}));var n=a(146),r=a(430),l=a(399),i=a(627),u=a(605),o=a(536);function s(e){return!e.portalItem||e.portalItem instanceof l.default||(e={...e,portalItem:new l.default(e.portalItem)}),function(e){return e.load().then(c).then(d)}(e.portalItem).then((t=>{const a={portalItem:e.portalItem,...t.properties};return new(0,t.constructor)(a)}))}function c(e){switch(e.type){case"Map Service":return function(e){return Object(o.a)(e.url).then((e=>e.tileInfo))}(e).then((e=>e?{className:"TileLayer"}:{className:"MapImageLayer"}));case"Feature Service":return function(e){return y(e).then((e=>{if("object"==typeof e){const t={};return null!=e.id&&(t.layerId=e.id),{className:"FeatureLayer",properties:t}}return{className:"GroupLayer"}}))}(e);case"Feature Collection":return async function(e){if(await e.load(),Object(u.d)(e,"Map Notes"))return{className:"MapNotesLayer"};if(Object(u.d)(e,"Route Layer"))return{className:"RouteLayer"};const t=await e.fetchData();return 1===Object(i.getNumLayersAndTables)(t)?{className:"FeatureLayer"}:{className:"GroupLayer"}}(e);case"Scene Service":return function(e){return y(e).then((t=>{if("object"==typeof t){const a={};let n;if(null!=t.id?(a.layerId=t.id,n="".concat(e.url,"/layers/").concat(t.id)):n=e.url,Array.isArray(e.typeKeywords)&&e.typeKeywords.length>0){const t={IntegratedMesh:"IntegratedMeshLayer","3DObject":"SceneLayer",Point:"SceneLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};for(const a of Object.keys(t))if(e.typeKeywords.includes(a))return{className:t[a]}}return Object(o.a)(n).then((e=>{let t="SceneLayer";const n={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};return e&&e.layerType&&n[e.layerType]&&(t=n[e.layerType]),{className:t,properties:a}}))}return!1===t?Object(o.a)(e.url).then((e=>"Voxel"===(null===e||void 0===e?void 0:e.layerType)?{className:"VoxelLayer"}:{className:"GroupLayer"})):{className:"GroupLayer"}}))}(e);case"Image Service":return async function(e){var t,a,n,r;await e.load();const l=null!==(t=null===(a=e.typeKeywords)||void 0===a?void 0:a.map((e=>e.toLowerCase())))&&void 0!==t?t:[];if(l.includes("elevation 3d layer"))return{className:"ElevationLayer"};if(l.includes("tiled imagery"))return{className:"ImageryTileLayer"};const i=null===(n=await e.fetchData())||void 0===n?void 0:n.layerType;if("ArcGISTiledImageServiceLayer"===i)return{className:"ImageryTileLayer"};if("ArcGISImageServiceLayer"===i)return{className:"ImageryLayer"};return"map"===(null===(r=(await Object(o.a)(e.url)).cacheType)||void 0===r?void 0:r.toLowerCase())?{className:"ImageryTileLayer"}:{className:"ImageryLayer"}}(e);case"Stream Service":case"Feed":return{className:"StreamLayer"};case"Vector Tile Service":return{className:"VectorTileLayer"};case"KML":return{className:"KMLLayer"};case"WFS":return{className:"WFSLayer"};case"WMTS":return{className:"WMTSLayer"};case"WMS":return{className:"WMSLayer"};default:return Promise.reject(new n.a("portal:unknown-item-type","Unknown item type '${type}'",{type:e.type}))}}function d(e){return(0,r.a[e.className])().then((t=>({constructor:t,properties:e.properties})))}function y(e){return!e.url||e.url.match(/\/\d+$/)?Promise.resolve({}):e.load().then((()=>e.fetchData())).then((async t=>"Feature Service"===e.type?p(t=await Object(i.preprocessFSItemData)(t,e.url)):Object(i.getNumLayersAndTables)(t)>0?p(t):Object(o.a)(e.url).then(p)))}function p(e){return 1===Object(i.getNumLayersAndTables)(e)&&{id:Object(i.getFirstLayerOrTableId)(e)}}},430:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={BingMapsLayer:async()=>(await a.e(170).then(a.bind(null,671))).default,BuildingSceneLayer:async()=>(await Promise.all([a.e(29),a.e(171)]).then(a.bind(null,647))).default,CSVLayer:async()=>(await a.e(99).then(a.bind(null,672))).default,ElevationLayer:async()=>(await a.e(33).then(a.bind(null,661))).default,FeatureLayer:async()=>(await Promise.resolve().then(a.bind(null,381))).default,GroupLayer:async()=>(await a.e(38).then(a.bind(null,540))).default,GeoRSSLayer:async()=>(await a.e(172).then(a.bind(null,637))).default,GeoJSONLayer:async()=>(await a.e(100).then(a.bind(null,673))).default,ImageryLayer:async()=>(await Promise.all([a.e(3),a.e(14),a.e(25),a.e(101)]).then(a.bind(null,645))).default,ImageryTileLayer:async()=>(await Promise.all([a.e(3),a.e(14),a.e(25),a.e(32),a.e(84)]).then(a.bind(null,648))).default,IntegratedMeshLayer:async()=>(await a.e(72).then(a.bind(null,662))).default,KMLLayer:async()=>(await a.e(111).then(a.bind(null,674))).default,LineOfSightLayer:async()=>(await a.e(106).then(a.bind(null,652))).default,MapImageLayer:async()=>(await Promise.all([a.e(34),a.e(82)]).then(a.bind(null,638))).default,MapNotesLayer:async()=>(await a.e(112).then(a.bind(null,639))).default,OGCFeatureLayer:async()=>(await a.e(77).then(a.bind(null,675))).default,OpenStreetMapLayer:async()=>(await a.e(102).then(a.bind(null,640))).default,PointCloudLayer:async()=>(await a.e(70).then(a.bind(null,650))).default,RouteLayer:async()=>(await a.e(62).then(a.bind(null,646))).default,SceneLayer:async()=>(await Promise.all([a.e(29),a.e(107)]).then(a.bind(null,655))).default,StreamLayer:async()=>(await a.e(173).then(a.bind(null,676))).default,TileLayer:async()=>(await Promise.all([a.e(34),a.e(85)]).then(a.bind(null,641))).default,UnknownLayer:async()=>(await a.e(174).then(a.bind(null,642))).default,UnsupportedLayer:async()=>(await a.e(175).then(a.bind(null,643))).default,VectorTileLayer:async()=>(await Promise.all([a.e(28),a.e(66)]).then(a.bind(null,649))).default,VoxelLayer:async()=>(await a.e(86).then(a.bind(null,644))).default,WebTileLayer:async()=>(await a.e(113).then(a.bind(null,488))).default,WFSLayer:async()=>(await a.e(74).then(a.bind(null,677))).default,WMSLayer:async()=>(await a.e(83).then(a.bind(null,663))).default,WMTSLayer:async()=>(await a.e(78).then(a.bind(null,653))).default}},482:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return i}));var n=a(168),r=a(241);function l(e){return{origin:"portal-item",url:Object(n.M)(e.itemUrl),portal:e.portal||r.a.getDefault(),portalItem:e,readResourcePaths:[]}}function i(e){return{origin:"portal-item",messages:[],writtenProperties:[],url:e.itemUrl?Object(n.M)(e.itemUrl):null,portal:e.portal||r.a.getDefault(),portalItem:e}}},536:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(167);async function r(e){const{data:t}=await Object(n.default)(e,{responseType:"json",query:{f:"json"}});return t}},627:function(e,t,a){"use strict";a.r(t),a.d(t,"getFirstLayerOrTableId",(function(){return m})),a.d(t,"getNumLayersAndTables",(function(){return L})),a.d(t,"load",(function(){return s})),a.d(t,"preprocessFSItemData",(function(){return f}));var n=a(146),r=a(430),l=a(241),i=a(482),u=a(525),o=a(536);async function s(e,t){const a=e.instance.portalItem;if(a&&a.id)return await a.load(t),function(e){const t=e.instance.portalItem;if(!e.supportedTypes.includes(t.type))throw new n.a("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}'",{type:t.type,expectedType:e.supportedTypes.join(", ")})}(e),async function(e,t){const a=e.instance,n=a.portalItem,{url:r,title:l}=n,o=Object(i.a)(n);if("group"===a.type)return a.read({title:l},o),c(a,e);r&&a.read({url:r},o);const s=await p(e,t);return s&&a.read(s,o),a.resourceReferences={portalItem:n,paths:o.readResourcePaths},a.read({title:l},o),Object(u.a)(a,o)}(e,t)}function c(e,t){let a;const l=e.portalItem.type;switch(l){case"Feature Service":case"Feature Collection":a=r.a.FeatureLayer;break;case"Stream Service":a=r.a.StreamLayer;break;case"Scene Service":a=r.a.SceneLayer;break;default:throw new n.a("portal:unsupported-item-type-as-group","The item type '".concat(l,"' is not supported as a 'IGroupLayer'"))}let i;return a().then((e=>(i=e,p(t)))).then((async t=>"Feature Service"===l?(t=await f(t,e.portalItem.url),d(e,i,t)):L(t)>0?d(e,i,t):function(e,t){return e.portalItem.url?Object(o.a)(e.portalItem.url).then((a=>{var n,r;function l(e){return{id:e.id,name:e.name}}a&&d(e,t,{layers:null===(n=a.layers)||void 0===n?void 0:n.map(l),tables:null===(r=a.tables)||void 0===r?void 0:r.map(l)})})):Promise.resolve()}(e,i)))}function d(e,t,a){let n=a.layers||[];const r=a.tables||[];"Feature Collection"===e.portalItem.type&&(n.forEach((e=>{var t;"Table"===(null===e||void 0===e||null===(t=e.layerDefinition)||void 0===t?void 0:t.type)&&r.push(e)})),n=n.filter((e=>{var t;return"Table"!==(null===e||void 0===e||null===(t=e.layerDefinition)||void 0===t?void 0:t.type)}))),n.reverse().forEach((n=>{const r=y(e,t,a,n);e.add(r)})),r.reverse().forEach((n=>{const r=y(e,t,a,n);e.tables.add(r)}))}function y(e,t,a,n){const r=new t({portalItem:e.portalItem.clone(),layerId:n.id,sublayerTitleMode:"service-name"});if("Feature Collection"===e.portalItem.type){const t={origin:"portal-item",portal:e.portalItem.portal||l.a.getDefault()};r.read(n,t);const i=a.showLegend;null!=i&&r.read({showLegend:i},t)}return r}function p(e,t){if(!1===e.supportsData)return Promise.resolve(void 0);const a=e.instance;return a.portalItem.fetchData("json",t).catch((()=>null)).then((async e=>{if(function(e){return"stream"!==e.type&&"layerId"in e}(a)){let t,n=!0;return e&&L(e)>0&&(null==a.layerId&&(a.layerId=m(e)),t=function(e,t){const a=e.layers;if(a)for(let r=0;r<a.length;r++)if(a[r].id===t)return a[r];const n=e.tables;if(n)for(let r=0;r<n.length;r++)if(n[r].id===t)return n[r];return null}(e,a.layerId),t&&(1===L(e)&&(n=!1),null!=e.showLegend&&(t.showLegend=e.showLegend))),n&&"service-name"!==a.sublayerTitleMode&&(a.sublayerTitleMode="item-title-and-service-name"),t}return e}))}async function f(e,t){var a,n;if(null==(null===(a=e)||void 0===a?void 0:a.layers)||null==(null===(n=e)||void 0===n?void 0:n.tables)){const a=await Object(o.a)(t);(e=e||{}).layers=e.layers||(null===a||void 0===a?void 0:a.layers),e.tables=e.tables||(null===a||void 0===a?void 0:a.tables)}return e}function m(e){const t=e.layers;if(t&&t.length)return t[0].id;const a=e.tables;return a&&a.length?a[0].id:null}function L(e){var t,a,n,r;return(null!==(t=null===e||void 0===e||null===(a=e.layers)||void 0===a?void 0:a.length)&&void 0!==t?t:0)+(null!==(n=null===e||void 0===e||null===(r=e.tables)||void 0===r?void 0:r.length)&&void 0!==n?n:0)}}}]);