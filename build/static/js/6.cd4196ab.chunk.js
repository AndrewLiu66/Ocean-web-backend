(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[6],{259:function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return I})),n.d(t,"e",(function(){return V})),n.d(t,"f",(function(){return j})),n.d(t,"g",(function(){return O}));var i=n(135),s=n(154);const a=(e,t,n)=>[t,n],r=(e,t,n)=>[t,n,e[2]],o=(e,t,n)=>[t,n,e[2],e[3]];function l(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:Object(i.k)(e.extent)?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function u(e,t){let{scale:n,translate:i}=e;return Math.round((t-i[0])/n[0])}function c(e,t){let{scale:n,translate:i}=e;return Math.round((i[1]-t)/n[1])}function f(e,t,n){const i=[];let s,a,r,o;for(let l=0;l<n.length;l++){const f=n[l];l>0?(r=u(e,f[0]),o=c(e,f[1]),r===s&&o===a||(i.push(t(f,r-s,o-a)),s=r,a=o)):(s=u(e,f[0]),a=c(e,f[1]),i.push(t(f,s,a)))}return i.length>0?i:null}function d(e,t){let{scale:n,translate:i}=e;return t*n[0]+i[0]}function h(e,t){let{scale:n,translate:i}=e;return i[1]-t*n[1]}function m(e,t,n){const i=new Array(n.length);if(!n.length)return i;const[s,a]=e.scale;let r=d(e,n[0][0]),o=h(e,n[0][1]);i[0]=t(n[0],r,o);for(let l=1;l<n.length;l++){const e=n[l];r+=e[0]*s,o-=e[1]*a,i[l]=t(e,r,o)}return i}function p(e,t,n){const i=new Array(n.length);for(let s=0;s<n.length;s++)i[s]=m(e,t,n[s]);return i}function g(e,t,n,i,s){return t.points=function(e,t,n,i){return f(e,n?i?o:r:i?r:a,t)}(e,n.points,i,s),t}function b(e,t,n,i,s){return t.x=u(e,n.x),t.y=c(e,n.y),t!==n&&(i&&(t.z=n.z),s&&(t.m=n.m)),t}function y(e,t,n,i,s){const l=function(e,t,n,i){const s=[],l=n?i?o:r:i?r:a;for(let a=0;a<t.length;a++){const n=f(e,l,t[a]);n&&n.length>=3&&s.push(n)}return s.length?s:null}(e,n.rings,i,s);return l?(t.rings=l,t):null}function x(e,t,n,i,s){const l=function(e,t,n,i){const s=[],l=n?i?o:r:i?r:a;for(let a=0;a<t.length;a++){const n=f(e,l,t[a]);n&&n.length>=2&&s.push(n)}return s.length?s:null}(e,n.paths,i,s);return l?(t.paths=l,t):null}function v(e,t){return e&&t?Object(s.f)(t)?b(e,{},t,!1,!1):Object(s.h)(t)?x(e,{},t,!1,!1):Object(s.g)(t)?y(e,{},t,!1,!1):Object(s.e)(t)?g(e,{},t,!1,!1):Object(s.d)(t)?function(e,t,n,i,s){return t.xmin=u(e,n.xmin),t.ymin=c(e,n.ymin),t.xmax=u(e,n.xmax),t.ymax=c(e,n.ymax),t!==n&&(i&&(t.zmin=n.zmin,t.zmax=n.zmax),s&&(t.mmin=n.mmin,t.mmax=n.mmax)),t}(e,{},t,!1,!1):null:null}function I(e,t,n,s,l){return Object(i.k)(n)&&(t.points=function(e,t,n,i){return m(e,n?i?o:r:i?r:a,t)}(e,n.points,s,l)),t}function V(e,t,n,s,a){return Object(i.j)(n)||(t.x=d(e,n.x),t.y=h(e,n.y),t!==n&&(s&&(t.z=n.z),a&&(t.m=n.m))),t}function j(e,t,n,s,l){return Object(i.k)(n)&&(t.rings=function(e,t,n,i){return p(e,n?i?o:r:i?r:a,t)}(e,n.rings,s,l)),t}function O(e,t,n,s,l){return Object(i.k)(n)&&(t.paths=function(e,t,n,i){return p(e,n?i?o:r:i?r:a,t)}(e,n.paths,s,l)),t}},266:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return b}));var i=n(135),s=n(240),a=n(305),r=n(171),o=n(294);const l=[0,0];function u(e,t){if(!t)return null;if("x"in t){const n={x:0,y:0};return[n.x,n.y]=e(t.x,t.y,l),null!=t.z&&(n.z=t.z),null!=t.m&&(n.m=t.m),n}if("xmin"in t){const n={xmin:0,ymin:0,xmax:0,ymax:0};return[n.xmin,n.ymin]=e(t.xmin,t.ymin,l),[n.xmax,n.ymax]=e(t.xmax,t.ymax,l),t.hasZ&&(n.zmin=t.zmin,n.zmax=t.zmax,n.hasZ=!0),t.hasM&&(n.mmin=t.mmin,n.mmax=t.mmax,n.hasM=!0),n}return"rings"in t?{rings:c(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:c(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:f(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function c(e,t){const n=[];for(const i of e)n.push(f(i,t));return n}function f(e,t){const n=[];for(const i of e){const e=t(i[0],i[1],[0,0]);n.push(e),i.length>2&&e.push(i[2]),i.length>3&&e.push(i[3])}return n}async function d(e,t){if(!t)return;const n=Array.isArray(e)?e.map((e=>Object(i.k)(e.geometry)&&e.geometry.spatialReference)):[e];await Object(s.d)(n.map((e=>({source:e,dest:t}))))}const h=u.bind(null,o.c),m=u.bind(null,o.f);function p(e,t,n,i){if(!e)return e;if(n||(n=t,t=e.spatialReference),!Object(r.l)(t)||!Object(r.l)(n)||Object(r.d)(t,n))return e;if(Object(o.a)(t,n)){const t=Object(r.p)(n)?h(e):m(e);return t.spatialReference=n,t}return Object(s.i)(a.a,[e],t,n,null,i)[0]}const g=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(e,t,n){if(!e||!e.length||!t||!n||Object(r.d)(t,n))return e;const i={geometries:e,inSpatialReference:t,outSpatialReference:n,resolve:null};return this._jobs.push(i),new Promise((e=>{i.resolve=e,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const e=this._jobs.shift();if(!e)return;const{geometries:t,inSpatialReference:n,outSpatialReference:i,resolve:l}=e;Object(o.a)(n,i)?Object(r.p)(i)?l(t.map(h)):l(t.map(m)):l(Object(s.i)(a.a,t,n,i,null,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function b(e,t,n){return g.push(e,t,n)}},305:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,n){const i=new s(e.getPointX(t),e.getPointY(t),n),a=e.hasZ(t),r=e.hasM(t);return a&&(i.z=e.getPointZ(t)),r&&(i.m=e.getPointM(t)),i},exportPolygon:function(e,t,n){return new a(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,n){return new r(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,n){return new o(e.exportPoints(t),n,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,n){const i=e.hasZ(t),s=e.hasM(t),a=new l(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),n);if(i){const n=e.getZExtent(t);a.zmin=n.vmin,a.zmax=n.vmax}if(s){const n=e.getMExtent(t);a.mmin=n.vmin,a.mmax=n.vmax}return a}};class s{constructor(e,t,n){this.x=e,this.y=t,this.spatialReference=n,this.z=void 0,this.m=void 0}}class a{constructor(e,t,n,i){this.rings=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),i&&(this.hasM=i)}}class r{constructor(e,t,n,i){this.paths=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),i&&(this.hasM=i)}}class o{constructor(e,t,n,i){this.points=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),i&&(this.hasM=i)}}class l{constructor(e,t,n,i,s){this.xmin=e,this.ymin=t,this.xmax=n,this.ymax=i,this.spatialReference=s,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},340:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(135);function s(e,t){return e?t?4:3:t?3:2}function a(e,t,n,a,l){if(Object(i.j)(t)||!t.lengths.length)return null;const u="upperLeft"===(null===l||void 0===l?void 0:l.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);const c=e.coords,f=[],d=n?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:h,coords:m}=t,p=s(n,a);let g=0;for(const i of h){const e=r(d,m,g,i,n,a,u);e&&f.push(e),g+=i*p}if(f.sort(((e,t)=>{let i=u*e[2]-u*t[2];return 0===i&&n&&(i=e[4]-t[4]),i})),f.length){let e=6*f[0][2];c[0]=f[0][0]/e,c[1]=f[0][1]/e,n&&(e=6*f[0][4],c[2]=0!==e?f[0][3]/e:0),(c[0]<d[0]||c[0]>d[1]||c[1]<d[2]||c[1]>d[3]||n&&(c[2]<d[4]||c[2]>d[5]))&&(c.length=0)}if(!c.length){const e=t.lengths[0]?o(m,0,h[0],n,a):null;if(!e)return null;c[0]=e[0],c[1]=e[1],n&&e.length>2&&(c[2]=e[2])}return e}function r(e,t,n,i,a,r){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;const l=s(a,r);let u=n,c=n+l,f=0,d=0,h=0,m=0,p=0;for(let s=0,b=i-1;s<b;s++,u+=l,c+=l){const n=t[u],i=t[u+1],s=t[u+2],r=t[c],o=t[c+1],l=t[c+2];let g=n*o-r*i;m+=g,f+=(n+r)*g,d+=(i+o)*g,a&&(g=n*l-r*s,h+=(s+l)*g,p+=g),n<e[0]&&(e[0]=n),n>e[1]&&(e[1]=n),i<e[2]&&(e[2]=i),i>e[3]&&(e[3]=i),a&&(s<e[4]&&(e[4]=s),s>e[5]&&(e[5]=s))}if(m*o>0&&(m*=-1),p*o>0&&(p*=-1),!m)return null;const g=[f,d,.5*m];return a&&(g[3]=h,g[4]=.5*p),g}function o(e,t,n,i,a){const r=s(i,a);let o=t,d=t+r,h=0,m=0,p=0,g=0;for(let s=0,b=n-1;s<b;s++,o+=r,d+=r){const t=e[o],n=e[o+1],s=e[o+2],a=e[d],r=e[d+1],b=e[d+2],y=i?u(t,n,s,a,r,b):l(t,n,a,r);if(y)if(h+=y,i){const e=f(t,n,s,a,r,b);m+=y*e[0],p+=y*e[1],g+=y*e[2]}else{const e=c(t,n,a,r);m+=y*e[0],p+=y*e[1]}}return h>0?i?[m/h,p/h,g/h]:[m/h,p/h]:n>0?i?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function l(e,t,n,i){const s=n-e,a=i-t;return Math.sqrt(s*s+a*a)}function u(e,t,n,i,s,a){const r=i-e,o=s-t,l=a-n;return Math.sqrt(r*r+o*o+l*l)}function c(e,t,n,i){return[e+.5*(n-e),t+.5*(i-t)]}function f(e,t,n,i,s,a){return[e+.5*(i-e),t+.5*(s-t),n+.5*(a-n)]}},504:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return I})),n.d(t,"e",(function(){return V})),n.d(t,"f",(function(){return x}));var i=n(187),s=n(135),a=n(231),r=n(589),o=n(154),l=n(264),u=n(171),c=(n(340),n(175)),f=n(198),d=n(266);const h=new i.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),m=Object.freeze({}),p=new f.a,g=new f.a,b=new f.a,y={esriGeometryPoint:c.m,esriGeometryPolyline:c.o,esriGeometryPolygon:c.n,esriGeometryMultipoint:c.l};function x(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.hasZ,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.hasM;if(Object(s.j)(t))return null;const r=e.hasZ&&i,o=e.hasM&&a;if(n){const s=Object(c.u)(b,t,e.hasZ,e.hasM,"esriGeometryPoint",n,i,a);return Object(c.m)(s,r,o)}return Object(c.m)(t,r,o)}function v(e,t,n,i,a,r){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:n;const u=t&&o,f=n&&l,d=Object(s.k)(i)?"coords"in i?i:i.geometry:null;if(Object(s.j)(d))return null;if(a){let i=Object(c.q)(g,d,t,n,e,a,o,l);return r&&(i=Object(c.u)(b,i,u,f,e,r)),y[e](i,u,f)}if(r){const i=Object(c.u)(b,d,t,n,e,r,o,l);return y[e](i,u,f)}return Object(c.x)(p,d,t,n,o,l),y[e](p,u,f)}async function I(e,t,n){const{outFields:i,orderByFields:s,groupByFieldsForStatistics:a,outStatistics:r}=e;if(i)for(let o=0;o<i.length;o++)i[o]=i[o].trim();if(s)for(let o=0;o<s.length;o++)s[o]=s[o].trim();if(a)for(let o=0;o<a.length;o++)a[o]=a[o].trim();if(r)for(let o=0;o<r.length;o++)r[o].onStatisticField&&(r[o].onStatisticField=r[o].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),V(e,t,n)}async function V(e,t,i){if(!e)return null;let{where:c}=e;if(e.where=c=c&&c.trim(),(!c||/^1 *= *1$/.test(c)||t&&t===c)&&(e.where=null),!e.geometry)return e;let f=await async function(e){const{geometry:t,distance:i,units:s}=e;if(null==i||"vertexAttributes"in t)return t;const r=t.spatialReference,o=s?h.fromJSON(s):Object(a.e)(r),l=r&&(Object(u.h)(r)||Object(u.p)(r))?t:await Object(d.a)(r,u.b).then((()=>Object(d.b)(t,u.b)));return(await async function(){return(await Promise.all([n.e(5),n.e(12)]).then(n.bind(null,535))).geodesicBuffer}())(l.spatialReference,l,i,o)}(e);if(e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel){const{spatialReference:t}=e.geometry;f=Object(r.a)(f),f.spatialReference=t}e.geometry=f,await Object(d.a)(f.spatialReference,i);const p=(await Object(l.a)(Object(o.a)(f)))[0];if(Object(s.j)(p))throw m;const g=p.toJSON(),b=await Object(d.b)(g,g.spatialReference,i);if(!b)throw m;return b.spatialReference=i,e.geometry=b,e}function j(e){return e&&O in e?JSON.parse(JSON.stringify(e,F)):e}const O="_geVersion",F=(e,t)=>e!==O?t:void 0},616:function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return V})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return g})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return y})),n.d(t,"j",(function(){return l})),n.d(t,"k",(function(){return p})),n.d(t,"l",(function(){return I}));var i=n(681),s=n(617);const a=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,r=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),o=["min","max","avg","stddev","count","sum","variance","nullcount","median"];function l(e){const t=null!=e.normalizationField||null!=e.normalizationType,n=null!=e.minValue||null!=e.maxValue,i=!!e.sqlExpression&&e.supportsSQLExpression;return!t&&!n&&!i}function u(e){const t=e.returnDistinct?[...new Set(e.values)]:e.values,n=t.filter((e=>null!=e)).length,i={count:n};return e.supportsNullCount&&(i.nullcount=t.length-n),e.percentileParams&&(i.median=f(t,e.percentileParams)),i}function c(e){const{values:t,useSampleStdDev:n,supportsNullCount:i}=e;let s=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,r=null,o=null,l=null,u=null,c=0;const d=null==e.minValue?-1/0:e.minValue,h=null==e.maxValue?1/0:e.maxValue;for(const f of t)Number.isFinite(f)?f>=d&&f<=h&&(r+=f,s=Math.min(s,f),a=Math.max(a,f),c++):"string"==typeof f&&c++;if(c&&null!=r){o=r/c;let e=0;for(const n of t)Number.isFinite(n)&&n>=d&&n<=h&&(e+=(n-o)**2);u=n?c>1?e/(c-1):0:c>0?e/c:0,l=Math.sqrt(u)}else s=null,a=null;const m={avg:o,count:c,max:a,min:s,stddev:l,sum:r,variance:u};return i&&(m.nullcount=t.length-c),e.percentileParams&&(m.median=f(t,e.percentileParams)),m}function f(e,t){const{fieldType:n,value:i,orderBy:s,isDiscrete:a}=t,r=d(n,"desc"===s);if(0===(e=[...e].filter((e=>null!=e)).sort(((e,t)=>r(e,t)))).length)return null;if(i<=0)return e[0];if(i>=1)return e[e.length-1];const o=(e.length-1)*i,l=Math.floor(o),u=l+1,c=o%1,f=e[l],h=e[u];return u>=e.length||a||"string"==typeof f||"string"==typeof h?f:f*(1-c)+h*c}function d(e,t){const n=t?1:-1,i=function(e){return e?(e,t)=>t-e:(e,t)=>e-t}(t),s=h(t);if(!e||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...r].includes(e))return(e,t)=>"number"==typeof e&&"number"==typeof t?i(e,t):"string"==typeof e&&"string"==typeof t?s(e,t):n;if("esriFieldTypeDate"===e)return(e,t)=>{const s=new Date(e).getTime(),a=new Date(t).getTime();return isNaN(s)||isNaN(a)?n:i(s,a)};if(r.has(e))return(e,t)=>i(e,t);if("esriFieldTypeString"===e)return(e,t)=>s(e,t);if("esriFieldTypeGUID"===e||"esriFieldTypeGlobalID"===e){const e=h(t);return(t,n)=>e(m(t),m(n))}return t?(e,t)=>1:(e,t)=>-1}function h(e){return e?(e,t)=>{var n,i;return(e=null===(n=e)||void 0===n?void 0:n.toUpperCase())>(t=null===(i=t)||void 0===i?void 0:i.toUpperCase())?-1:e<t?1:0}:(e,t)=>{var n,i;return(e=null===(n=e)||void 0===n?void 0:n.toUpperCase())<(t=null===(i=t)||void 0===i?void 0:i.toUpperCase())?-1:e>t?1:0}}function m(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function p(e,t){let n;for(n in e)o.includes(n)&&(Number.isFinite(e[n])||(e[n]=null));return t?(["avg","stddev","variance"].forEach((t=>{null!=e[t]&&(e[t]=Math.ceil(e[t]))})),e):e}function g(e){const t={};for(let n of e)(null==n||"string"==typeof n&&""===n.trim())&&(n=null),null==t[n]?t[n]={count:1,data:n}:t[n].count++;return{count:t}}function b(e,t,n){const i=e.count,s=[];n&&t&&"coded-value"===t.type&&t.codedValues.forEach((e=>{const t=e.code;i.hasOwnProperty(t)||(i[t]={data:t,count:0})}));for(const a in i){const e=i[a];s.push({value:e.data,count:e.count,label:e.label})}return{uniqueValueInfos:s}}function y(e,t,n,i){let s=null;switch(t){case"log":0!==e&&(s=Math.log(e)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(i)&&0!==i&&(s=e/i*100);break;case"field":Number.isFinite(n)&&0!==n&&(s=e/n);break;case"natural-log":e>0&&(s=Math.log(e));break;case"square-root":e>0&&(s=e**.5)}return s}function x(e,t){const n=v({field:t.field,normalizationType:t.normalizationType,normalizationField:t.normalizationField,classificationMethod:t.classificationMethod,standardDeviationInterval:t.standardDeviationInterval,breakCount:t.numClasses||5});return e=function(e,t,n){return t=null==t?-1/0:t,n=null==n?1/0:n,e.filter((e=>Number.isFinite(e)&&e>=t&&e<=n))}(e,t.minValue,t.maxValue),Object(s.a)({definition:n,values:e,normalizationTotal:t.normalizationTotal})}function v(e){const t=e.field,n=e.classificationMethod||"equal-interval",s=e.normalizationType,a=e.normalizationField,r=new i.a;return r.classificationField=t,r.breakCount=e.breakCount,r.classificationMethod=n,r.standardDeviationInterval="standard-deviation"===n?e.standardDeviationInterval||1:void 0,r.normalizationType=s,r.normalizationField="field"===s?a:void 0,r}function I(e,t){let n=e.classBreaks;const i=n.length,s=n[0].minValue,r=n[i-1].maxValue,o="standard-deviation"===t,l=a;return n=n.map((e=>{const t=e.label,n={minValue:e.minValue,maxValue:e.maxValue,label:t};if(o&&t){const e=t.match(l).map((e=>+e.trim()));2===e.length?(n.minStdDev=e[0],n.maxStdDev=e[1],e[0]<0&&e[1]>0&&(n.hasAvg=!0)):1===e.length&&(t.includes("<")?(n.minStdDev=null,n.maxStdDev=e[0]):t.includes(">")&&(n.minStdDev=e[0],n.maxStdDev=null))}return n})),{minValue:s,maxValue:r,classBreakInfos:n,normalizationTotal:e.normalizationTotal}}function V(e,t){const{min:n,max:i,intervals:s}=j(e,t),a=s.map(((e,t)=>({minValue:s[t][0],maxValue:s[t][1],count:0})));for(const r of e)if(null!=r&&r>=n&&r<=i){const e=O(s,r);e>-1&&a[e].count++}return{bins:a,minValue:n,maxValue:i,normalizationTotal:t.normalizationTotal}}function j(e,t){const{field:n,classificationMethod:i,standardDeviationInterval:s,normalizationType:a,normalizationField:r,normalizationTotal:o,minValue:u,maxValue:f}=t,d=t.numBins||10;let h=null,m=null,p=null;if(i&&"equal-interval"!==i||a){const{classBreaks:t}=x(e,{field:n,normalizationType:a,normalizationField:r,normalizationTotal:o,classificationMethod:i,standardDeviationInterval:s,minValue:u,maxValue:f,numClasses:d});h=t[0].minValue,m=t[t.length-1].maxValue,p=t.map((e=>[e.minValue,e.maxValue]))}else{if(null!=u&&null!=f)h=u,m=f;else{const t=c({values:e,minValue:u,maxValue:f,useSampleStdDev:!a,supportsNullCount:l({normalizationType:a,normalizationField:r,minValue:u,maxValue:f})});h=t.min,m=t.max}p=function(e,t,n){const i=(t-e)/n,s=[];let a,r=e;for(let o=1;o<=n;o++)a=r+i,a=Number(a.toFixed(16)),s.push([r,o===n?t:a]),r=a;return s}(h,m,d)}return{min:h,max:m,intervals:p}}function O(e,t){let n=-1;for(let i=e.length-1;i>=0;i--)if(t>=e[i][0]){n=i;break}return n}},617:function(e,t,n){"use strict";function i(e,t){return Number(e.toFixed(t))}function s(e){const{normalizationTotal:t}=e;return{classBreaks:a(e),normalizationTotal:t}}function a(e){const t=e.definition,{classificationMethod:n,breakCount:s,normalizationType:a,definedInterval:u}=t,c=[];let f=e.values;if(0===f.length)return[];f=f.sort(((e,t)=>e-t));const d=f[0],h=f[f.length-1];if("equal-interval"===n)if(f.length>=s){const e=(h-d)/s;let t=d;for(let n=1;n<s;n++){const s=i(d+n*e,6);c.push({minValue:t,maxValue:s,label:r(t,s,a)}),t=s}c.push({minValue:t,maxValue:h,label:r(t,h,a)})}else f.forEach((e=>{c.push({minValue:e,maxValue:e,label:r(e,e,a)})}));else if("natural-breaks"===n){const t=o(f),n=e.valueFrequency||t.valueFrequency,u=l(t.uniqueValues,n,s);let m=d;for(let e=1;e<s;e++)if(t.uniqueValues.length>e){const n=i(t.uniqueValues[u[e]],6);c.push({minValue:m,maxValue:n,label:r(m,n,a)}),m=n}c.push({minValue:m,maxValue:h,label:r(m,h,a)})}else if("quantile"===n)if(f.length>=s&&d!==h){let e=d,t=Math.ceil(f.length/s),n=0;for(let i=1;i<s;i++){let o=t+n-1;o>f.length&&(o=f.length-1),o<0&&(o=0),c.push({minValue:e,maxValue:f[o],label:r(e,f[o],a)}),e=f[o],n+=t,t=Math.ceil((f.length-n)/(s-i))}c.push({minValue:e,maxValue:h,label:r(e,h,a)})}else{let e=-1;for(let t=0;t<f.length;t++){const n=f[t];n!==e&&(e=n,c.push({minValue:e,maxValue:n,label:r(e,n,a)}),e=n)}}else if("standard-deviation"===n){const e=function(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t/=e.length,t}(f),t=function(e,t){let n=0;for(let i=0;i<e.length;i++){const s=e[i];n+=(s-t)*(s-t)}return n/=e.length,Math.sqrt(n)}(f,e);if(0===t)c.push({minValue:f[0],maxValue:f[0],label:r(f[0],f[0],a)});else{const n=function(e,t,n,i,s){let a=Math.max(i-e,t-i)/s/n;return a=a>=1?1:a>=.5?.5:.25,a}(d,h,s,e,t)*t;let o=0,l=d;for(let t=s;t>=1;t--){const s=i(e-(t-.5)*n,6);c.push({minValue:l,maxValue:s,label:r(l,s,a)}),l=s,o++}let u=i(e+.5*n,6);c.push({minValue:l,maxValue:u,label:r(l,u,a)}),l=u,o++;for(let t=1;t<=s;t++)u=o===2*s?h:i(e+(t+.5)*n,6),c.push({minValue:l,maxValue:u,label:r(l,u,a)}),l=u,o++}}else if("defined-interval"===n){if(!u)return c;const e=f[0],t=f[f.length-1],n=Math.ceil((t-e)/u);let s=e;for(let o=1;o<n;o++){const t=i(e+o*u,6);c.push({minValue:s,maxValue:t,label:r(s,t,a)}),s=t}c.push({minValue:s,maxValue:t,label:r(s,t,a)})}return c}function r(e,t,n){let i=null;return i=e===t?n&&"percent-of-total"===n?e+"%":e.toString():n&&"percent-of-total"===n?e+"% - "+t+"%":e+" - "+t,i}function o(e){const t=[],n=[];let i=Number.MIN_VALUE,s=1,a=-1;for(let r=0;r<e.length;r++){const o=e[r];o===i?(s++,n[a]=s):null!==o&&(t.push(o),i=o,s=1,n.push(s),a++)}return{uniqueValues:t,valueFrequency:n}}function l(e,t,n){const i=e.length,s=[];n>i&&(n=i);for(let r=0;r<n;r++)s.push(Math.round(r*i/n-1));s.push(i-1);let a=u(s,e,t,n);return function(e,t,n,i,s,a){let r=0,o=0,l=0,u=0,f=!0;for(let d=0;d<2&&f;d++){0===d&&(f=!1);for(let d=0;d<a-1;d++)for(;n[d+1]+1!==n[d+2];){n[d+1]=n[d+1]+1;const a=c(d,n,i,s);l=a.sbMean,r=a.sbSdcm;const h=c(d+1,n,i,s);if(u=h.sbMean,o=h.sbSdcm,!(r+o<t[d]+t[d+1])){n[d+1]=n[d+1]-1;break}t[d]=r,t[d+1]=o,e[d]=l,e[d+1]=u,f=!0}for(let d=a-1;d>0;d--)for(;n[d]!==n[d-1]+1;){n[d]=n[d]-1;const a=c(d-1,n,i,s);l=a.sbMean,r=a.sbSdcm;const h=c(d,n,i,s);if(u=h.sbMean,o=h.sbSdcm,!(r+o<t[d-1]+t[d])){n[d]=n[d]+1;break}t[d-1]=r,t[d]=o,e[d-1]=l,e[d]=u,f=!0}}return f}(a.mean,a.sdcm,s,e,t,n)&&(a=u(s,e,t,n)),s}function u(e,t,n,i){let s=[],a=[],r=[],o=0;const l=[],u=[];for(let m=0;m<i;m++){const i=c(m,e,t,n);l.push(i.sbMean),u.push(i.sbSdcm),o+=u[m]}let f,d=o,h=!0;for(;h||o<d;){h=!1,s=[];for(let t=0;t<i;t++)s.push(e[t]);for(let n=0;n<i;n++)for(let s=e[n]+1;s<=e[n+1];s++)if(f=t[s],n>0&&s!==e[n+1]&&Math.abs(f-l[n])>Math.abs(f-l[n-1]))e[n]=s;else if(n<i-1&&e[n]!==s-1&&Math.abs(f-l[n])>Math.abs(f-l[n+1])){e[n+1]=s-1;break}d=o,o=0,a=[],r=[];for(let s=0;s<i;s++){a.push(l[s]),r.push(u[s]);const i=c(s,e,t,n);l[s]=i.sbMean,u[s]=i.sbSdcm,o+=u[s]}}if(o>d){for(let t=0;t<i;t++)e[t]=s[t],l[t]=a[t],u[t]=r[t];o=d}return{mean:l,sdcm:u}}function c(e,t,n,i){let s=0,a=0;for(let l=t[e]+1;l<=t[e+1];l++){const e=i[l];s+=n[l]*e,a+=e}a<=0&&console.log("Exception in Natural Breaks calculation");const r=s/a;let o=0;for(let l=t[e]+1;l<=t[e+1];l++)o+=i[l]*(n[l]-r)**2;return{sbMean:r,sbSdcm:o}}n.d(t,"a",(function(){return s}))},681:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var i=n(137),s=n(187),a=n(140),r=(n(142),n(136),n(139),n(138)),o=n(151),l=n(560),u=n(393);const c=new s.a({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"});let f=class extends o.a{constructor(){super(...arguments),this.baseSymbol=null,this.colorRamp=null,this.type=null}};Object(i.a)([Object(a.b)({type:u.a,json:{write:!0}})],f.prototype,"baseSymbol",void 0),Object(i.a)([Object(a.b)({types:l.b,json:{read:{reader:l.a},write:!0}})],f.prototype,"colorRamp",void 0),Object(i.a)([Object(a.b)({json:{read:c.read,write:c.write}})],f.prototype,"type",void 0),f=Object(i.a)([Object(r.a)("esri.rest.support.ClassificationDefinition")],f);const d=f,h=new s.a({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"}),m=new s.a({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});let p=class extends d{constructor(){super(...arguments),this.breakCount=null,this.classificationField=null,this.classificationMethod=null,this.normalizationField=null,this.normalizationType=null,this.type="class-breaks-definition"}set standardDeviationInterval(e){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",e)}set definedInterval(e){"defined-interval"===this.classificationMethod&&this._set("definedInterval",e)}};Object(i.a)([Object(a.b)({json:{write:!0}})],p.prototype,"breakCount",void 0),Object(i.a)([Object(a.b)({json:{write:!0}})],p.prototype,"classificationField",void 0),Object(i.a)([Object(a.b)({type:String,json:{read:h.read,write:h.write}})],p.prototype,"classificationMethod",void 0),Object(i.a)([Object(a.b)({json:{write:!0}})],p.prototype,"normalizationField",void 0),Object(i.a)([Object(a.b)({json:{read:m.read,write:m.write}})],p.prototype,"normalizationType",void 0),Object(i.a)([Object(a.b)({value:null,json:{write:!0}})],p.prototype,"standardDeviationInterval",null),Object(i.a)([Object(a.b)({value:null,json:{write:!0}})],p.prototype,"definedInterval",null),Object(i.a)([Object(a.b)()],p.prototype,"type",void 0),p=Object(i.a)([Object(r.a)("esri.rest.support.ClassBreaksDefinition")],p);const g=p},915:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return f}));var i=n(135),s=n(336),a=n(589),r=n(259),o=n(171),l=n(917),u=n(616);class c{constructor(e,t,n){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues,this.fieldsIndex=n,this.featureAdapter=t;const i=e.outFields;if(i&&!i.includes("*")){this.outFields=i;let e=0;for(const t of i){const i=Object(l.b)(t),s=this.fieldsIndex.get(i),a=s?null:Object(l.c)(i,n),r=s?s.name:Object(l.a)(t)||"FIELD_EXP_"+e++;this._fieldDataCache.set(t,{alias:r,clause:a})}}}countDistinctValues(e){return this.returnDistinctValues?(e.forEach((e=>this.getAttributes(e))),this._returnDistinctMap.size):e.length}getAttributes(e){const t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}getFieldValue(e,t,n){const i=n?n.name:t;let s=null;return this._fieldDataCache.has(i)?s=this._fieldDataCache.get(i).clause:n||(s=Object(l.c)(t,this.fieldsIndex),this._fieldDataCache.set(i,{alias:i,clause:s})),n?this.featureAdapter.getAttribute(e,i):s.calculateValue(e,this.featureAdapter)}getNormalizedValue(e,t){const n=t.normalizationType,i=t.normalizationTotal;let s=this.getFieldValue(e,t.field,t.fieldInfo);if(n&&Number.isFinite(s)){const a=this.getFieldValue(e,t.normalizationField,t.normalizationFieldInfo);s=Object(u.i)(s,n,a,i)}return s}getExpressionValue(e,t,n,i){const s={attributes:this.featureAdapter.getAttributes(e),layer:{fields:this.fieldsIndex.fields}},a=i.createExecContext(s,n);return i.executeFunction(t,a)}getExpressionValues(e,t,n,i){const s={fields:this.fieldsIndex.fields};return e.map((e=>{const a={attributes:this.featureAdapter.getAttributes(e),layer:s},r=i.createExecContext(a,n);return i.executeFunction(t,r)}))}validateItem(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:Object(l.c)(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)}validateItems(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:Object(l.c)(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)}_processAttributesForOutFields(e){const t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);const n={};for(const i of t){const{alias:t,clause:s}=this._fieldDataCache.get(i);n[t]=s?s.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,t)}return n}_processAttributesForDistinctValues(e){if(Object(i.j)(e)||!this.returnDistinctValues)return e;const t=this.outFields,n=[];if(t)for(const i of t){const{alias:t}=this._fieldDataCache.get(i);n.push(e[t])}else for(const i in e)n.push(e[i]);const s="".concat((t||["*"]).join(","),"=").concat(n.join(","));let a=this._returnDistinctMap.get(s)||0;return this._returnDistinctMap.set(s,++a),a>1?null:e}}var f,d,h=n(266),m=n(504),p=n(235),g=n(257);class b{constructor(e,t,n){this.items=e,this.query=t,this.geometryType=n.geometryType,this.hasM=n.hasM,this.hasZ=n.hasZ,this.fieldsIndex=n.fieldsIndex,this.objectIdField=n.objectIdField,this.spatialReference=n.spatialReference,this.featureAdapter=n.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const e=new c(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return e.countDistinctValues(this.items);const{groupByFieldsForStatistics:t,having:n,outStatistics:i}=this.query;if(!(null===t||void 0===t?void 0:t.length))return 1;const s=new Map,a=new Map,r=new Set;for(const o of i){const{statisticType:i}=o,l="exceedslimit"!==i?o.onStatisticField:void 0;if(!a.has(l)){const n=[];for(const i of t){const t=this._getAttributeValues(e,i,s);n.push(t)}a.set(l,this._calculateUniqueValues(n,e.returnDistinctValues))}const u=a.get(l);for(const t in u){const{data:i,items:s}=u[t],a=i.join(",");n&&!e.validateItems(s,n)||r.add(a)}}return r.size}async createQueryResponse(){let e;return e=this.query.outStatistics?this.query.outStatistics.some((e=>"exceedslimit"===e.statisticType))?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query),this.query.returnQueryGeometry&&(Object(o.l)(this.query.outSR)&&!Object(o.d)(this.query.geometry.spatialReference,this.query.outSR)?e.queryGeometry=Object(m.b)({spatialReference:this.query.outSR,...Object(h.b)(this.query.geometry,this.query.geometry.spatialReference,this.query.outSR)}):e.queryGeometry=Object(m.b)({spatialReference:this.query.outSR,...this.query.geometry})),e}createSnappingResponse(e,t){const n=this.featureAdapter,s=function(e,t){return e?t?4:3:t?3:2}(this.hasZ,this.hasM),{x:a,y:r}=e.point,o="number"==typeof e.distance?e.distance:e.distance.x,l="number"==typeof e.distance?e.distance:e.distance.y,u={candidates:[]},c="esriGeometryPolygon"===this.geometryType,d=this._getPointCreator(e.point,this.spatialReference,t);for(const h of this.items){const t=n.getGeometry(h);if(Object(i.j)(t))continue;const{coords:m,lengths:p}=t;if(e.types&f.EDGE){let e=0;for(let t=0;t<p.length;t++){const i=p[t];for(let t=0;t<i;t++,e+=s){const c=m[e],f=m[e+1];if(t!==i-1){const t=m[e+s],i=m[e+s+1],{x:p,y:g}=y(a,r,c,f,t,i),b=(a-p)/o,x=(r-g)/l,v=b*b+x*x;v<=1&&u.candidates.push({type:"edge",objectId:n.getObjectId(h),distance:Math.sqrt(v),target:d(p,g),start:d(c,f),end:d(t,i)})}}}}if(e.types&f.VERTEX){const e=c?m.length-s:m.length;for(let t=0;t<e;t+=s){const e=m[t],i=m[t+1],s=(a-e)/o,c=(r-i)/l,f=s*s+c*c;f<=1&&u.candidates.push({type:"vertex",objectId:n.getObjectId(h),distance:Math.sqrt(f),target:d(e,i)})}}}return u.candidates.sort(((e,t)=>e.distance-t.distance)),u}_getPointCreator(e,t,n){const s=Object(i.k)(n)&&!Object(o.d)(t,n)?e=>Object(h.b)(e,t,n):e=>e;return null!=e.z&&null!=e.m?(t,n)=>s({x:t,y:n,z:e.z,m:e.m}):null!=e.z?(t,n)=>s({x:t,y:n,z:e.z}):null!=e.m?(t,n)=>s({x:t,y:n,m:e.m}):(e,t)=>s({x:e,y:t})}async createSummaryStatisticsResponse(e){const{field:t,valueExpression:n,normalizationField:i,normalizationType:s,normalizationTotal:a,minValue:r,maxValue:o,scale:l}=e,c=this.fieldsIndex.isDateField(t),f=await this._getDataValues({field:t,valueExpression:n,normalizationField:i,normalizationType:s,normalizationTotal:a,scale:l}),d=Object(u.j)({normalizationType:s,normalizationField:i,minValue:r,maxValue:o}),h=this.fieldsIndex.get(t),m={value:.5,fieldType:null===h||void 0===h?void 0:h.type},g=Object(p.r)(h)?Object(u.e)({values:f,supportsNullCount:d,percentileParams:m}):Object(u.d)({values:f,minValue:r,maxValue:o,useSampleStdDev:!s,supportsNullCount:d,percentileParams:m});return Object(u.k)(g,c)}async createUniqueValuesResponse(e){const{field:t,valueExpression:n,domain:i,returnAllCodedValues:s,scale:a}=e,r=await this._getDataValues({field:t,valueExpression:n,scale:a}),o=Object(u.f)(r);return Object(u.g)(o,i,s)}async createClassBreaksResponse(e){const{field:t,valueExpression:n,normalizationField:i,normalizationType:s,normalizationTotal:a,classificationMethod:r,standardDeviationInterval:o,minValue:l,maxValue:c,numClasses:f,scale:d}=e,h=await this._getDataValues({field:t,valueExpression:n,normalizationField:i,normalizationType:s,normalizationTotal:a,scale:d}),m=Object(u.a)(h,{field:t,normalizationField:i,normalizationType:s,normalizationTotal:a,classificationMethod:r,standardDeviationInterval:o,minValue:l,maxValue:c,numClasses:f});return Object(u.l)(m,r)}async createHistogramResponse(e){const{field:t,valueExpression:n,normalizationField:i,normalizationType:s,normalizationTotal:a,classificationMethod:r,standardDeviationInterval:o,minValue:l,maxValue:c,numBins:f,scale:d}=e,h=await this._getDataValues({field:t,valueExpression:n,normalizationField:i,normalizationType:s,normalizationTotal:a,scale:d});return Object(u.b)(h,{field:t,normalizationField:i,normalizationType:s,normalizationTotal:a,classificationMethod:r,standardDeviationInterval:o,minValue:l,maxValue:c,numBins:f})}_sortFeatures(e,t,n){if(e.length>1&&t&&t.length)for(const i of t.reverse()){const t=i.split(" "),s=t[0],a=this.fieldsIndex.get(s),r=t[1]&&"desc"===t[1].toLowerCase(),o=Object(u.h)(null===a||void 0===a?void 0:a.type,r);e.sort(((e,t)=>{const i=n(e,s,a),r=n(t,s,a);return o(i,r)}))}}_createFeatureQueryResponse(e){const t=this.items,{geometryType:n,hasM:i,hasZ:s,objectIdField:a,spatialReference:o}=this,{outFields:l,outSR:u,quantizationParameters:c,resultRecordCount:f,resultOffset:d,returnZ:h,returnM:p}=e,g=null!=f&&t.length>(d||0)+f,b=l&&(l.includes("*")?[...this.fieldsIndex.fields]:l.map((e=>this.fieldsIndex.get(e))));return{exceededTransferLimit:g,features:this._createFeatures(e,t),fields:b,geometryType:n,hasM:i&&p,hasZ:s&&h,objectIdFieldName:a,spatialReference:Object(m.b)(u||o),transform:c&&Object(r.c)(c)||null}}_createFeatures(e,t){const n=new c(e,this.featureAdapter,this.fieldsIndex),{hasM:i,hasZ:s}=this,{orderByFields:a,quantizationParameters:o,returnGeometry:l,returnCentroid:u,maxAllowableOffset:f,resultOffset:d,resultRecordCount:h,returnZ:p=!1,returnM:g=!1}=e,b=s&&p,y=i&&g;let x=[],v=0;const I=[...t];if(this._sortFeatures(I,a,((e,t,i)=>n.getFieldValue(e,t,i))),l||u){const e=Object(r.c)(o);if(l&&!u)for(const t of I)x[v++]={attributes:n.getAttributes(t),geometry:Object(m.c)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),f,e,b,y)};else if(!l&&u)for(const t of I)x[v++]={attributes:n.getAttributes(t),centroid:Object(m.f)(this,this.featureAdapter.getCentroid(t,this),e)};else for(const t of I)x[v++]={attributes:n.getAttributes(t),centroid:Object(m.f)(this,this.featureAdapter.getCentroid(t,this),e),geometry:Object(m.c)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),f,e,b,y)}}else for(const r of I){const e=n.getAttributes(r);e&&(x[v++]={attributes:e})}const V=d||0;if(null!=h){const e=V+h;x=x.slice(V,Math.min(x.length,e))}return x}_createExceedsLimitQueryResponse(e){let t=!1,n=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY;for(const i of e.outStatistics)if("exceedslimit"===i.statisticType){n=null!=i.maxPointCount?i.maxPointCount:Number.POSITIVE_INFINITY,s=null!=i.maxRecordCount?i.maxRecordCount:Number.POSITIVE_INFINITY,a=null!=i.maxVertexCount?i.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)t=this.items.length>n;else if(this.items.length>s)t=!0;else{const e=this.hasZ?this.hasM?4:3:this.hasM?3:2,n=this.featureAdapter;t=this.items.reduce(((e,t)=>{const s=n.getGeometry(t);return e+(Object(i.k)(s)&&s.coords.length||0)}),0)/e>a}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}}async _createStatisticsQueryResponse(e){const t={attributes:{}},n=[],i=new Map,s=new Map,a=new Map,r=new Map,o=new c(e,this.featureAdapter,this.fieldsIndex),l=e.outStatistics,{groupByFieldsForStatistics:u,having:f,orderByFields:d}=e,h=u&&u.length,m=!!h,p=m&&u[0],g=m&&!this.fieldsIndex.get(p);for(const c of l){const{outStatisticFieldName:e,statisticType:l}=c,d=c,b="exceedslimit"!==l?c.onStatisticField:void 0,y="percentile_disc"===l||"percentile_cont"===l,x="EnvelopeAggregate"===l||"CentroidAggregate"===l||"ConvexHullAggregate"===l,v=m&&1===h&&(b===p||g)&&"count"===l;if(m){if(!a.has(b)){const e=[];for(const t of u){const n=this._getAttributeValues(o,t,i);e.push(n)}a.set(b,this._calculateUniqueValues(e,o.returnDistinctValues))}const t=a.get(b);for(const n in t){const{count:s,data:a,items:l,itemPositions:c}=t[n],h=a.join(",");if(!f||o.validateItems(l,f)){const t=r.get(h)||{attributes:{}};if(x){t.aggregateGeometries||(t.aggregateGeometries={});const{aggregateGeometries:e,outStatisticFieldName:n}=await this._getAggregateGeometry(d,l);t.aggregateGeometries[n]=e}else{let n=null;if(v)n=s;else{const e=this._getAttributeValues(o,b,i),t=c.map((t=>e[t]));n=y&&"statisticParameters"in d?this._getPercentileValue(d,t):this._getStatisticValue(d,t,null,o.returnDistinctValues)}t.attributes[e]=n}u.forEach(((e,n)=>t.attributes[this.fieldsIndex.get(e)?e:"EXPR_".concat(n+1)]=a[n])),r.set(h,t)}}}else if(x){t.aggregateGeometries||(t.aggregateGeometries={});const{aggregateGeometries:e,outStatisticFieldName:n}=await this._getAggregateGeometry(d,this.items);t.aggregateGeometries[n]=e}else{const n=this._getAttributeValues(o,b,i);t.attributes[e]=y&&"statisticParameters"in d?this._getPercentileValue(d,n):this._getStatisticValue(d,n,s,o.returnDistinctValues)}n.push({name:e,alias:e,type:"esriFieldTypeDouble"})}const b=m?Array.from(r.values()):[t];return this._sortFeatures(b,d,((e,t)=>e.attributes[t])),{fields:n,features:b}}async _getAggregateGeometry(e,t){const i=await Promise.all([n.e(5),n.e(12)]).then(n.bind(null,535)),{statisticType:r,outStatisticFieldName:o}=e,{featureAdapter:l,spatialReference:u,geometryType:c,hasZ:f,hasM:d}=this,h=t.map((e=>Object(m.c)(c,f,d,l.getGeometry(e)))),p=i.convexHull(u,h,!0)[0],g={aggregateGeometries:null,outStatisticFieldName:null};if("EnvelopeAggregate"===r){const e=p?Object(a.b)(p):Object(a.a)(i.union(u,h));g.aggregateGeometries={...e,spatialReference:u},g.outStatisticFieldName=o||"extent"}else if("CentroidAggregate"===r){const e=p?Object(s.b)(p):Object(s.a)(Object(a.a)(i.union(u,h)));g.aggregateGeometries={x:e[0],y:e[1],spatialReference:u},g.outStatisticFieldName=o||"centroid"}else"ConvexHullAggregate"===r&&(g.aggregateGeometries=p,g.outStatisticFieldName=o||"convexHull");return g}_getStatisticValue(e,t,n,i){const{onStatisticField:s,statisticType:a}=e;let r=null;return r=null!==n&&void 0!==n&&n.has(s)?n.get(s):Object(p.r)(this.fieldsIndex.get(s))?Object(u.e)({values:t,returnDistinct:i}):Object(u.d)({values:t,minValue:null,maxValue:null,useSampleStdDev:!0}),n&&n.set(s,r),r["var"===a?"variance":a]}_getPercentileValue(e,t){const{onStatisticField:n,statisticParameters:i,statisticType:s}=e,{value:a,orderBy:r}=i,o=this.fieldsIndex.get(n);return Object(u.c)(t,{value:a,orderBy:r,fieldType:null===o||void 0===o?void 0:o.type,isDiscrete:"percentile_disc"===s})}_getAttributeValues(e,t,n){if(n.has(t))return n.get(t);const i=this.fieldsIndex.get(t),s=this.items.map((n=>e.getFieldValue(n,t,i)));return n.set(t,s),s}_getAttributeNormalizedValues(e,t){return this.items.map((n=>e.getNormalizedValue(n,{field:t.field,fieldInfo:this.fieldsIndex.get(t.field),normalizationField:t.normalizationField,normalizationFieldInfo:this.fieldsIndex.get(t.normalizationField),normalizationType:t.normalizationType,normalizationTotal:t.normalizationTotal})))}async _getAttributeExpressionValues(e,t,n){const{arcadeUtils:i}=await Object(g.e)(),s=i.createFunction(t),a=n&&i.getViewInfo(n);return e.getExpressionValues(this.items,s,a,i)}_calculateUniqueValues(e,t){const n={},i=this.items,s=i.length;for(let a=0;a<s;a++){const s=i[a],r=[];for(const t of e)r.push(t[a]);const o=r.join(",");t?null==n[o]&&(n[o]={count:1,data:r,items:[s],itemPositions:[a]}):null==n[o]?n[o]={count:1,data:r,items:[s],itemPositions:[a]}:(n[o].count++,n[o].items.push(s),n[o].itemPositions.push(a))}return n}async _getDataValues(e){const t=new c(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:n,field:i,normalizationField:s,normalizationType:a,normalizationTotal:r,scale:o}=e,l=n?{viewingMode:"map",scale:o,spatialReference:this.query.outSR||this.spatialReference}:null;return n?this._getAttributeExpressionValues(t,n,l):this._getAttributeNormalizedValues(t,{field:i,normalizationField:s,normalizationType:a,normalizationTotal:r})}}function y(e,t,n,i,s,a){const r=s-n,o=a-i,l=r*r+o*o,u=(e-n)*r+(t-i)*o,c=Math.min(1,Math.max(0,u/l));return{x:n+r*c,y:i+o*c}}(d=f||(f={}))[d.NONE=0]="NONE",d[d.EDGE=1]="EDGE",d[d.VERTEX=2]="VERTEX"},917:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return h})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return c}));var i=n(146),s=n(807),a=n(435);const r=new class{constructor(e,t){this._cache=new s.a(e),this._invalidCache=new s.a(t)}get(e,t){const n="".concat(t.uid,":").concat(e),i=this._cache.get(n);if(i)return i;if(void 0!==this._invalidCache.get(n))return null;try{const i=a.WhereClause.create(e,t);return this._cache.put(n,i),i}catch{return this._invalidCache.put(n,null),null}}}(50,500),o="feature-store:unsupported-query",l=" as ",u=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function c(e,t){if(!t)return!0;const n=r.get(t,e);if(!n)throw new i.a(o,"invalid SQL expression",{where:t});if(!n.isStandardized)throw new i.a(o,"where clause is not standard",{where:t});return h(e,n.fieldNames,"where clause contains missing fields"),!0}function f(e,t,n){if(!t)return!0;const s=r.get(t,e);if(!s)throw new i.a(o,"invalid SQL expression",{having:t});if(!s.isAggregate)throw new i.a(o,"having does not contain a valid aggregate function",{having:t});const a=s.fieldNames;if(h(e,a,"having contains missing fields"),!s.getExpressions().every((t=>{const{aggregateType:i,field:s}=t,a=e.has(s)&&e.get(s).name;return n.some((t=>{const{onStatisticField:n,statisticType:s}=t;return(e.has(n)&&e.get(n).name)===a&&s.toLowerCase().trim()===i}))})))throw new i.a(o,"expressions in having should also exist in outStatistics",{having:t});return!0}function d(e,t){return e?r.get(e,t):null}function h(e,t,n){let s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const a=[];for(const l of t)if("*"!==l&&!e.has(l))if(s){const t=m(l);try{const n=d(t,e);if(!n)throw new i.a(o,"invalid SQL expression",{where:t});if(!n.isStandardized)throw new i.a(o,"expression is not standard",{clause:n});h(e,n.fieldNames,"expression contains missing fields")}catch(r){const e=r&&r.details;if(e&&(e.clause||e.where))throw r;e&&e.missingFields?a.push(...e.missingFields):a.push(l)}}else a.push(l);if(a.length)throw new i.a(o,n,{missingFields:a})}function m(e){return e.split(l)[0]}function p(e){return e.split(l)[1]}function g(e,t){const n=t.get(e);return!!n&&!u.has(n.type)}}}]);